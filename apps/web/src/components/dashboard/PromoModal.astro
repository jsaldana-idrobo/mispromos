---
type PromoModalProps = {
  promoTypes?: string[];
  promoTypeLabels?: Record<string, string>;
  days?: string[];
};

const {
  promoTypes = [],
  promoTypeLabels = {},
  days = [],
} = Astro.props as PromoModalProps;
---

<div
  class="fixed inset-0 z-50 hidden flex items-center justify-center bg-ink-900/40 p-4 backdrop-blur-sm"
  data-promo-modal-overlay
  hidden
>
  <div
    class="max-h-[90vh] w-full max-w-3xl overflow-y-auto rounded-3xl border border-ink-900/10 bg-white/95 p-6 shadow-2xl"
    data-promo-modal
  >
    <div class="flex items-start justify-between gap-4">
      <div>
        <p class="text-xs uppercase tracking-[0.2em] text-ink-900/50">
          Promociones
        </p>
        <h3 class="text-2xl font-semibold" data-promo-modal-title>
          Crear promoción
        </h3>
      </div>
      <button
        class="rounded-full border border-ink-900/20 px-3 py-1 text-xs"
        type="button"
        data-promo-modal-close
      >
        Cerrar
      </button>
    </div>
    <form class="mt-6 grid gap-4" data-promo-form>
      <div class="flex items-center justify-end text-xs text-ink-900/60"></div>
      <label
        class="grid gap-2 text-sm font-semibold"
        data-business-select-row="promo"
      >
        Negocio
        <select
          class="input-field"
          name="businessId"
          data-business-select
          required></select>
      </label>
      <label class="grid gap-2 text-sm font-semibold">
        Sede (opcional)
        <select class="input-field" name="branchId" data-branch-select>
          <option value="">Global</option>
        </select>
      </label>
      <label class="grid gap-2 text-sm font-semibold">
        Título
        <input class="input-field" name="title" required />
      </label>
      <label class="grid gap-2 text-sm font-semibold">
        Descripción (opcional)
        <textarea class="input-field" name="description" rows={2}></textarea>
      </label>
      <label class="grid gap-2 text-sm font-semibold">
        Foto (url opcional)
        <input
          class="input-field"
          type="url"
          name="imageUrl"
          placeholder="https://..."
        />
      </label>
      <label class="grid gap-2 text-sm font-semibold">
        Foto (archivo opcional)
        <input
          class="input-field"
          type="file"
          name="imageFile"
          accept="image/*"
          data-promo-image-file
        />
      </label>
      <div class="hidden" data-promo-image-preview-wrapper>
        <img
          class="h-40 w-full rounded-2xl border border-ink-900/10 object-cover"
          alt="Vista previa de la promoción"
          data-promo-image-preview
        />
      </div>
      <label class="grid gap-2 text-sm font-semibold">
        Tipo de promo
        <select class="input-field" name="promoType" required>
          {
            promoTypes.map((type: string) => (
              <option value={type}>{promoTypeLabels[type]}</option>
            ))
          }
        </select>
      </label>
      <label class="grid gap-2 text-sm font-semibold">
        Valor (opcional)
        <input class="input-field" name="value" placeholder="50% / 2x1" />
      </label>
      <div class="grid gap-2">
        <span class="text-sm font-semibold">Días de la semana</span>
        <div class="flex flex-wrap gap-2 text-sm">
          {
            days.map((day: string) => (
              <label class="flex items-center gap-2 rounded-full border border-ink-900/10 bg-sand-100 px-3 py-1">
                <input type="checkbox" name="daysOfWeek" value={day} checked />
                <span class="capitalize">{day}</span>
              </label>
            ))
          }
        </div>
      </div>
      <div class="grid gap-4 sm:grid-cols-2">
        <label class="grid gap-2 text-sm font-semibold">
          Inicio (fecha)
          <input class="input-field" type="date" name="startDate" />
        </label>
        <label class="grid gap-2 text-sm font-semibold">
          Fin (fecha)
          <input class="input-field" type="date" name="endDate" />
        </label>
        <label class="grid gap-2 text-sm font-semibold">
          Hora inicio (opcional)
          <input class="input-field" type="time" name="startHour" />
        </label>
        <label class="grid gap-2 text-sm font-semibold">
          Hora fin (opcional)
          <input class="input-field" type="time" name="endHour" />
        </label>
      </div>
      <label class="flex items-center gap-2 text-sm">
        <input type="checkbox" name="active" checked />
        Activa
      </label>
      <p class="text-sm text-ink-900/60" data-promo-message></p>
      <button class="button-primary" type="submit">Guardar promoción</button>
    </form>
  </div>
</div>
